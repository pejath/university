<div class="container">
  <% if !@students.empty? %>
    <div class="mb-3 d-flex justify-content-between">
      <%= link_to 'Create', new_student_path, class: "btn btn-primary" %>
      <%= select_tag('group', options_for_select(([''] << @groups_id.order(:id).map { |group| group.id }).flatten, params[:group_id]), class: "") %>
    </div>

    <table class="table table-hover table-bordered" style="background-color: #f5f5f5;">
      <thead>
      <tr>
        <th>Group</th>
        <th>Name</th>
        <% if current_user.is_admin? %>
          <th>Token</th>
          <th colspan="3"></th>
        <% else %>
          <% if current_user.is_lecturer? %>
            <th colspan="2"></th>
          <% else %>
            <th colspan="1"></th>
          <% end %>
        <% end %>
      </tr>
      </thead>
      <tbody>
      <%= render @students %>
      </tbody>
    </table>
  <% else %>
    <p>Такой группы не существует или в ней нет студентов</p>
  <% end %>


  <script>
      const select = document.getElementById('group');
      const check = document.getElementById('red_diplomas');
      select.addEventListener("change", async (e) => {
          const url = window.location.href.split(/[/?]/);
          while (url[url.length - 1] !== 'students') {
              url.pop();
          }
          location.href = url.join('/') + '?group_id=' + e.target.value;
      });
  </script>
</div>
