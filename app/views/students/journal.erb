<div>
<p>\n</p>

<%= select_tag('group', options_for_select(@groups_id.order(:id).map{|group| group.id}<<'', params[:group])) %>
<p></p>
<% if @students.all.size>0 %>
<table>
  <tbody>

  <% @students.order(:group_id).each do |student| %>
    <tr>
      <td><%= student.group_id %></td>
      <td><%= student.name %></td>
      <td>
        <% @marks.where(student_id: student.id).each do |mark| %>
          <%= mark.mark %>
        <% end %>
      <td><%= student.average_mark %></td>
    </tr>
  <% end %>

  </tbody>

  <thead>
  <tr>
    <th>Group</th>
    <th>Name</th>
    <th>Marks</th>
    <th>Average</th>
    <th colspan="3"></th>


  </tr>
  </thead>
</table>
  <% else %>
    <p>There is no such group or in group 0 students</p>
  <% end %>

<script>
    const select = document.getElementById('group');
    select.addEventListener("change", async (e) => {
        const url =  window.location.href.split('/');
        if (url[-1] !== 'students') {
            url.pop();
        }
        location.href = url.join('/') + '/' + e.target.value
    })
</script>
</div>